# è½»é‡çº§æ™ºèƒ½æ–‡æ¡£é…å›¾å·¥å…· - è®¾è®¡æ–‡æ¡£

## é¡¹ç›®å®šä½

### äº§å“æ„¿æ™¯
ä¸€ä¸ªè¶…ç®€å•çš„å·¥å…·ï¼Œè®©åˆ›ä¸šè€…å’ŒæŠ€æœ¯åšä¸»èƒ½å¤Ÿä¸€é”®æŠŠçº¯æ–‡å­—å†…å®¹å˜æˆå›¾æ–‡å¹¶èŒ‚çš„ç²¾ç¾æ–‡æ¡£ã€‚

**æ ¸å¿ƒä½“éªŒï¼š**
> ç²˜è´´æ–‡å­— â†’ ç‚¹å‡»æŒ‰é’® â†’ 30ç§’åå¾—åˆ°é…å¥½å›¾çš„å†…å®¹

### ç›®æ ‡ç”¨æˆ·

**ä¸»è¦ç”¨æˆ·ç¾¤ä½“ï¼š**

1. **åˆåˆ›å…¬å¸CEO/åˆ›å§‹äºº**
   - éœ€è¦äº§å‡ºå†…å®¹ï¼ˆå…¬å¸åšå®¢ã€äº§å“ä»‹ç»ã€Newsletterï¼‰
   - æœ‰å°è¿è¥ä½†å¸Œæœ›ææ•ˆ
   - æ²¡é¢„ç®—è¯·è®¾è®¡å¸ˆ
   - å¯¹å·¥å…·çš„è¦æ±‚ï¼šå¿«é€Ÿã€å¥½ç”¨ã€ä¸ç”¨å­¦ä¹ 

2. **å…¼èŒæŠ€æœ¯åšä¸»**
   - åœ¨å°çº¢ä¹¦ã€æ˜é‡‘ã€çŸ¥ä¹ç­‰å¹³å°å‘å†…å®¹
   - æœ‰æŠ€æœ¯å†…å®¹ä½†ä¸ä¼šé…å›¾
   - å¸Œæœ›å†…å®¹æ›´æœ‰å¸å¼•åŠ›
   - å¯¹å·¥å…·çš„è¦æ±‚ï¼šç»“æœå¥½çœ‹ã€çœæ—¶é—´ã€é€‚åˆç¤¾äº¤åª’ä½“

**ç”¨æˆ·è§„æ¨¡é¢„æœŸï¼š**
- ç¬¬ä¸€æ‰¹ï¼š10-20ä¸ªæœ‹å‹
- è‡ªç„¶å¢é•¿ï¼šå£ç¢‘ä¼ æ’­
- ä¸ä¸»åŠ¨æ¨å¹¿ï¼Œé äº§å“æœ¬èº«

### æ ¸å¿ƒä»·å€¼ä¸»å¼ 

**å¯¹åˆ›ä¸šè€…ï¼š**
- "è®©ä½ çš„å°è¿è¥æ•ˆç‡ç¿»å€"
- "10åˆ†é’Ÿäº§å‡ºä¸“ä¸šå†…å®¹"
- "ä¸éœ€è¦è®¾è®¡å¸ˆä¹Ÿèƒ½åšå‡ºå¥½çœ‹çš„å†…å®¹"

**å¯¹æŠ€æœ¯åšä¸»ï¼š**
- "å†™å®Œæ–‡ç« ï¼Œè‡ªåŠ¨é…å›¾"
- "å°çº¢ä¹¦ç¬”è®°ç§’å˜å›¾æ–‡å¹¶èŒ‚"
- "æŠ€æœ¯å†…å®¹ä¹Ÿèƒ½å¾ˆå¥½çœ‹"

### éç›®æ ‡

**ä¸æ˜¯ï¼š**
- âŒ å¤æ‚çš„ä¼ä¸šå·¥å…·
- âŒ éœ€è¦åŸ¹è®­æ‰èƒ½ç”¨çš„ç³»ç»Ÿ
- âŒ å…¨èƒ½çš„å†…å®¹åˆ›ä½œå¹³å°

**åªæ˜¯ï¼š**
- âœ… ä¸€ä¸ªå°å·¥å…·
- âœ… è§£å†³ä¸€ä¸ªå…·ä½“é—®é¢˜ï¼šç»™æ–‡æ¡£é…å›¾
- âœ… ç”¨å®Œå°±èµ°

---

## äº§å“è®¾è®¡

### æ ¸å¿ƒåŠŸèƒ½

#### 1. æ™ºèƒ½é…å›¾ï¼ˆæ ¸å¿ƒï¼‰

**è¾“å…¥ï¼š**
- Markdownæ–‡æœ¬
- æˆ–çº¯æ–‡æœ¬ï¼ˆè‡ªåŠ¨è¯†åˆ«æ®µè½ï¼‰

**å¤„ç†ï¼š**
1. AIåˆ†æå†…å®¹ç»“æ„
2. å†³å®šåœ¨å“ªé‡Œæ’å›¾ï¼ˆ3-5å¼ ï¼‰
3. å†³å®šæ¯å¼ å›¾çš„å†…å®¹
4. è‡ªåŠ¨ç”Ÿæˆå›¾ç‰‡
5. æ’å…¥åˆ°åˆé€‚ä½ç½®

**è¾“å‡ºï¼š**
- å¸¦å›¾ç‰‡çš„Markdown
- å¯ç›´æ¥å¤åˆ¶æˆ–ä¸‹è½½
- å›¾ç‰‡å·²ä¸Šä¼ åˆ°CDNï¼ˆæ°¸ä¹…é“¾æ¥ï¼‰

**ç‰¹ç‚¹ï¼š**
- å…¨è‡ªåŠ¨ï¼Œä¸éœ€è¦ç”¨æˆ·åšä»»ä½•å†³ç­–
- å¿«é€Ÿï¼ˆ30-60ç§’å®Œæˆï¼‰
- è´¨é‡ç¨³å®š

#### 2. ç®€å•åé¦ˆï¼ˆè½»é‡çº§"å­¦ä¹ "ï¼‰

**ç”¨æˆ·å¯ä»¥ï¼š**
- ç»™ç»“æœæ‰“åˆ†ï¼ˆ1-5æ˜Ÿï¼‰
- ç®€å•è¯„è®ºï¼š"å¤ªå¥½äº†" / "å›¾ç‰‡ä½ç½®ä¸å¯¹" / "é£æ ¼ä¸å–œæ¬¢"
- æ ‡è®°ç‰¹åˆ«å¥½çš„æ¡ˆä¾‹ï¼š"è¿™ä¸ªå¾ˆæ£’ï¼"

**ç³»ç»Ÿä¼šï¼š**
- è®°å½•æ‰€æœ‰åé¦ˆ
- å®šæœŸï¼ˆæ¯å‘¨/æ¯æœˆï¼‰äººå·¥å›é¡¾
- æ‰‹åŠ¨è°ƒæ•´ç”Ÿæˆç­–ç•¥
- é€æ¸ä¼˜åŒ–æ•ˆæœ

**ä¸ä¼šï¼š**
- âŒ å®æ—¶è‡ªåŠ¨å­¦ä¹ ï¼ˆå¤ªå¤æ‚ï¼‰
- âŒ ä¸ªæ€§åŒ–æ¯ä¸ªç”¨æˆ·ï¼ˆæ—©æœŸä¸éœ€è¦ï¼‰
- âŒ A/Bæµ‹è¯•ç³»ç»Ÿï¼ˆoverkillï¼‰

#### 3. å¹³å°é€‚é…ï¼ˆé’ˆå¯¹åšä¸»ï¼‰

**å°çº¢ä¹¦æ¨¡å¼ï¼š**
- è‡ªåŠ¨ç”Ÿæˆå°é¢å›¾ï¼ˆ1:1æˆ–3:4æ¯”ä¾‹ï¼‰
- å›¾ç‰‡é£æ ¼æ›´æ´»æ³¼ã€æ›´å¸å¼•çœ¼çƒ
- è‡ªåŠ¨åŠ æ°´å°ï¼ˆå¯é€‰ï¼‰
- ç”Ÿæˆé€‚åˆæ‰‹æœºé˜…è¯»çš„æ’ç‰ˆ

**æŠ€æœ¯åšå®¢æ¨¡å¼ï¼š**
- ç”Ÿæˆæ ‡å‡†åšå®¢é…å›¾ï¼ˆ16:9ï¼‰
- é£æ ¼ç®€çº¦ã€ä¸“ä¸š
- é€‚åˆæ˜é‡‘ã€çŸ¥ä¹ã€ä¸ªäººåšå®¢

**é€šç”¨æ¨¡å¼ï¼š**
- æ ‡å‡†é…å›¾
- é€‚åˆä»»ä½•åœºæ™¯

---

## ç³»ç»Ÿæ¶æ„ï¼ˆæç®€ç‰ˆï¼‰

### æ•´ä½“æ¶æ„

```
ç”¨æˆ·ç•Œé¢ï¼ˆWebï¼‰
    â†“
åç«¯æœåŠ¡ï¼ˆFlask/FastAPIï¼‰
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Claude    â”‚   DALL-E 3  â”‚
â”‚ï¼ˆå¸ƒå±€åˆ†æï¼‰  â”‚  ï¼ˆå›¾ç‰‡ç”Ÿæˆï¼‰â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
å›¾ç‰‡CDNï¼ˆCloudflare/é˜¿é‡Œäº‘ï¼‰
    â†“
æ•°æ®åº“ï¼ˆSQLite/PostgreSQLï¼‰
ï¼ˆåªå­˜åŸºæœ¬è®°å½•å’Œåé¦ˆï¼‰
```

**å…³é”®åŸåˆ™ï¼š**
- ç®€å•ä¼˜å…ˆ
- èƒ½ç”¨ç¬¬ä¸‰æ–¹å°±ä¸è‡ªå·±é€ 
- æ—©æœŸä¸è€ƒè™‘æ€§èƒ½é—®é¢˜

### æŠ€æœ¯é€‰å‹

**åç«¯ï¼š**
- **è¯­è¨€**ï¼šPython 3.11+
- **æ¡†æ¶**ï¼šFastAPIï¼ˆå¿«é€Ÿã€ç°ä»£ã€å¼‚æ­¥ï¼‰
- **éƒ¨ç½²**ï¼šVercel / Railway / Renderï¼ˆå…è´¹æˆ–ä½æˆæœ¬ï¼‰

**å‰ç«¯ï¼š**
- **çº¯HTML + Vanilla JS**ï¼ˆä¸ç”¨Reactï¼Œä¿æŒç®€å•ï¼‰
- **CSS**ï¼šTailwind CDNï¼ˆä¸éœ€è¦æ„å»ºï¼‰
- **å›¾æ ‡**ï¼šLucide Iconsï¼ˆCDNï¼‰

**æ•°æ®åº“ï¼š**
- **æ—©æœŸ**ï¼šSQLiteï¼ˆæ–‡ä»¶æ•°æ®åº“ï¼Œå¤Ÿç”¨ï¼‰
- **æ‰©å±•**ï¼šPostgreSQLï¼ˆå¦‚æœçœŸçš„éœ€è¦ï¼‰

**AIæœåŠ¡ï¼š**
- **Claude**ï¼šAnthropic APIï¼ˆå¸ƒå±€åˆ†æï¼‰
- **DALL-E 3**ï¼šOpenAI APIï¼ˆå›¾ç‰‡ç”Ÿæˆï¼‰

**å­˜å‚¨ï¼š**
- **å›¾ç‰‡**ï¼šCloudflare R2ï¼ˆä¾¿å®œï¼‰æˆ–é˜¿é‡Œäº‘OSS
- **CDN**ï¼šè‡ªå¸¦CDN

**ç›‘æ§ï¼š**
- **é”™è¯¯è¿½è¸ª**ï¼šSentryï¼ˆå…è´¹ç‰ˆï¼‰
- **åˆ†æ**ï¼šç®€å•çš„æ—¥å¿—å°±å¤Ÿäº†

---

## æ ¸å¿ƒæ¨¡å—è®¾è®¡

### 1. æ–‡æ¡£å¤„ç†å™¨ï¼ˆDocument Processorï¼‰

**èŒè´£ï¼š**
- æ¥æ”¶ç”¨æˆ·è¾“å…¥
- è§£ææ–‡æ¡£ç»“æ„
- åè°ƒAIæœåŠ¡
- è¿”å›å¤„ç†ç»“æœ

**å…³é”®ä»£ç ç»“æ„ï¼š**

```python
class DocumentProcessor:
    """
    æ–‡æ¡£å¤„ç†æ ¸å¿ƒç±»
    """
    
    async def process(
        self,
        content: str,
        mode: str = "general"  # general/xiaohongshu/blog
    ) -> ProcessedDocument:
        """
        å¤„ç†æ–‡æ¡£çš„ä¸»æµç¨‹
        
        Args:
            content: åŸå§‹æ–‡æœ¬å†…å®¹
            mode: å¹³å°æ¨¡å¼
            
        Returns:
            ProcessedDocument: å¤„ç†åçš„æ–‡æ¡£å¯¹è±¡
        """
        
        # 1. æ¸…ç†å’Œè§£æå†…å®¹
        parsed = self.parse_content(content)
        
        # 2. è°ƒç”¨Claudeåˆ†æå¸ƒå±€
        layout_plan = await self.analyze_layout(
            parsed,
            mode=mode
        )
        
        # 3. å¹¶å‘ç”Ÿæˆæ‰€æœ‰å›¾ç‰‡
        images = await self.generate_images(
            layout_plan.image_specs
        )
        
        # 4. ç»„è£…æœ€ç»ˆæ–‡æ¡£
        result = self.assemble_document(
            original_content=content,
            layout_plan=layout_plan,
            images=images,
            mode=mode
        )
        
        # 5. ä¿å­˜è®°å½•ï¼ˆç”¨äºåç»­å­¦ä¹ ï¼‰
        await self.save_record(result)
        
        return result
    
    def parse_content(self, content: str) -> ParsedContent:
        """
        è§£æå†…å®¹ç»“æ„
        
        è¯†åˆ«ï¼š
        - æ ‡é¢˜ï¼ˆ# ## ###ï¼‰
        - æ®µè½
        - åˆ—è¡¨
        - ä»£ç å—
        - æ€»å­—æ•°
        """
        # ä½¿ç”¨markdown parseræˆ–ç®€å•çš„æ­£åˆ™è¡¨è¾¾å¼
        pass
    
    async def analyze_layout(
        self,
        parsed: ParsedContent,
        mode: str
    ) -> LayoutPlan:
        """
        è°ƒç”¨Claudeåˆ†æå¸ƒå±€
        """
        # æ„å»ºpromptï¼ˆæ ¹æ®modeè°ƒæ•´ï¼‰
        prompt = self.build_analysis_prompt(parsed, mode)
        
        # è°ƒç”¨Claude
        response = await self.claude_client.messages.create(
            model="claude-sonnet-4-20250514",
            max_tokens=2000,
            system=self.get_system_prompt(mode),
            messages=[{"role": "user", "content": prompt}]
        )
        
        # è§£æè¿”å›çš„JSON
        layout = self.parse_layout_response(response.content[0].text)
        
        return layout
    
    async def generate_images(
        self,
        image_specs: List[ImageSpec]
    ) -> List[GeneratedImage]:
        """
        å¹¶å‘ç”Ÿæˆæ‰€æœ‰å›¾ç‰‡
        """
        tasks = [
            self.generate_single_image(spec)
            for spec in image_specs
        ]
        
        images = await asyncio.gather(*tasks)
        
        return images
    
    async def generate_single_image(
        self,
        spec: ImageSpec
    ) -> GeneratedImage:
        """
        ç”Ÿæˆå•å¼ å›¾ç‰‡
        """
        # è°ƒç”¨DALL-E 3
        response = await self.openai_client.images.generate(
            model="dall-e-3",
            prompt=spec.prompt,
            size=spec.size,
            quality="standard"
        )
        
        image_url = response.data[0].url
        
        # ä¸‹è½½å¹¶ä¸Šä¼ åˆ°CDN
        cdn_url = await self.upload_to_cdn(image_url)
        
        return GeneratedImage(
            spec=spec,
            url=cdn_url,
            original_prompt=spec.prompt
        )
    
    def assemble_document(
        self,
        original_content: str,
        layout_plan: LayoutPlan,
        images: List[GeneratedImage],
        mode: str
    ) -> ProcessedDocument:
        """
        ç»„è£…æœ€ç»ˆæ–‡æ¡£
        
        æ ¹æ®modeä¸åŒï¼Œè¾“å‡ºæ ¼å¼å¯èƒ½ä¸åŒï¼š
        - general: æ ‡å‡†markdown
        - xiaohongshu: æ·»åŠ emojiï¼Œè°ƒæ•´æ’ç‰ˆ
        - blog: æ·»åŠ HTMLæ ‡ç­¾
        """
        # æŒ‰æ®µè½åˆ†å‰²åŸæ–‡
        paragraphs = self.split_into_paragraphs(original_content)
        
        # æ’å…¥å›¾ç‰‡
        for i, image in enumerate(images):
            insert_pos = layout_plan.image_specs[i].position
            
            # ç”Ÿæˆå›¾ç‰‡markdown
            img_markdown = self.format_image_markdown(
                image,
                mode=mode
            )
            
            # æ’å…¥åˆ°æŒ‡å®šä½ç½®
            paragraphs.insert(insert_pos, img_markdown)
        
        # æ ¹æ®modeè¿›è¡Œåå¤„ç†
        final_content = self.post_process(
            paragraphs,
            mode=mode
        )
        
        return ProcessedDocument(
            content=final_content,
            images=images,
            mode=mode
        )
```

---

### 2. Promptç®¡ç†å™¨ï¼ˆç®€åŒ–ç‰ˆï¼‰

**èŒè´£ï¼š**
- ç®¡ç†ä¸åŒæ¨¡å¼çš„prompt
- æ”¯æŒæ‰‹åŠ¨æ›´æ–°ä¼˜åŒ–
- è®°å½•promptç‰ˆæœ¬å†å²

**è®¾è®¡ï¼š**

```python
class PromptManager:
    """
    Promptç‰ˆæœ¬ç®¡ç†ï¼ˆç®€åŒ–ç‰ˆï¼‰
    
    æ ¸å¿ƒç†å¿µï¼š
    - ä¸åšè‡ªåŠ¨ä¼˜åŒ–ï¼ˆå¤ªå¤æ‚ï¼‰
    - æ‰‹åŠ¨è¿­ä»£ä¼˜åŒ–ï¼ˆåŸºäºåé¦ˆï¼‰
    - ç‰ˆæœ¬æ§åˆ¶ï¼ˆè®°å½•å†å²ï¼‰
    """
    
    def __init__(self):
        self.prompts = self.load_prompts()
        self.current_version = self.get_latest_version()
    
    def get_system_prompt(self, mode: str) -> str:
        """
        è·å–system prompt
        
        æ ¹æ®modeè¿”å›ä¸åŒçš„promptï¼š
        - general: é€šç”¨æ¨¡å¼
        - xiaohongshu: å°çº¢ä¹¦æ¨¡å¼
        - blog: æŠ€æœ¯åšå®¢æ¨¡å¼
        """
        return self.prompts[mode]['system']
    
    def get_analysis_template(self, mode: str) -> str:
        """
        è·å–åˆ†æpromptæ¨¡æ¿
        """
        return self.prompts[mode]['analysis']
    
    def update_prompt(
        self,
        mode: str,
        prompt_type: str,  # 'system' or 'analysis'
        new_content: str,
        reason: str  # æ›´æ–°åŸå› 
    ):
        """
        æ‰‹åŠ¨æ›´æ–°prompt
        
        ç”±äººå·¥æ ¹æ®åé¦ˆè°ƒæ•´
        """
        # ä¿å­˜æ—§ç‰ˆæœ¬
        old_version = self.prompts[mode][prompt_type]
        self.save_version_history(
            mode=mode,
            prompt_type=prompt_type,
            old_content=old_version,
            new_content=new_content,
            reason=reason
        )
        
        # æ›´æ–°å½“å‰ç‰ˆæœ¬
        self.prompts[mode][prompt_type] = new_content
        
        # å†™å…¥æ–‡ä»¶
        self.save_prompts()
    
    def load_prompts(self) -> Dict:
        """
        ä»YAMLæ–‡ä»¶åŠ è½½prompts
        """
        # prompts.yaml:
        # general:
        #   system: "..."
        #   analysis: "..."
        # xiaohongshu:
        #   system: "..."
        #   analysis: "..."
        pass
```

**Promptæ–‡ä»¶ç»“æ„ï¼š**

```yaml
# prompts.yaml

version: "1.2.0"
last_updated: "2026-01-15"

general:
  system: |
    ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„å†…å®¹ç¼–è¾‘å’Œè§†è§‰è®¾è®¡ä¸“å®¶ã€‚
    ä½ çš„ä»»åŠ¡æ˜¯åˆ†ææ–‡æ¡£å†…å®¹ï¼Œå†³å®šåœ¨å“ªé‡Œæ’å…¥æ’å›¾ã€‚
    
    æ ¸å¿ƒåŸåˆ™ï¼š
    1. æ’å›¾è¦æœ‰åŠ©äºç†è§£å†…å®¹ï¼Œä¸æ˜¯è£…é¥°
    2. ä½ç½®è¦åˆç†ï¼Œä¸æ‰“æ–­é˜…è¯»æµç•…åº¦
    3. æ•°é‡é€‚ä¸­ï¼šçŸ­æ–‡1-2å¼ ï¼Œä¸­ç­‰3-4å¼ ï¼Œé•¿æ–‡4-5å¼ 
    4. é£æ ¼ç»Ÿä¸€ï¼Œç®€çº¦ç°ä»£
    
  analysis: |
    è¯·åˆ†æä»¥ä¸‹æ–‡æ¡£ï¼Œå†³å®šæ’å›¾æ–¹æ¡ˆã€‚
    
    æ–‡æ¡£ä¿¡æ¯ï¼š
    - æ€»å­—æ•°: {word_count}
    - æ®µè½æ•°: {paragraph_count}
    
    æ–‡æ¡£å†…å®¹ï¼š
    {content}
    
    è¯·è¿”å›JSONæ ¼å¼...

xiaohongshu:
  system: |
    ä½ æ˜¯å°çº¢ä¹¦å†…å®¹è¿è¥ä¸“å®¶ã€‚
    ä½ çš„ä»»åŠ¡æ˜¯ä¸ºå°çº¢ä¹¦ç¬”è®°é…å›¾ã€‚
    
    å°çº¢ä¹¦é…å›¾ç‰¹ç‚¹ï¼š
    1. å°é¢å›¾æœ€é‡è¦ï¼Œè¦å¸å¼•çœ¼çƒ
    2. é£æ ¼æ´»æ³¼ã€è‰²å½©é²œè‰³
    3. å¯ä»¥ä½¿ç”¨emojiå’Œç½‘ç»œæµè¡Œå…ƒç´ 
    4. å›¾ç‰‡æ¯”ä¾‹é€‚åˆæ‰‹æœºï¼ˆ1:1æˆ–3:4ï¼‰
    
  analysis: |
    è¿™æ˜¯ä¸€ç¯‡å‡†å¤‡å‘å°çº¢ä¹¦çš„ç¬”è®°ã€‚
    
    å†…å®¹ï¼š
    {content}
    
    è¯·è®¾è®¡é…å›¾æ–¹æ¡ˆï¼Œç‰¹åˆ«æ³¨æ„å°é¢å›¾...

blog:
  system: |
    ä½ æ˜¯æŠ€æœ¯åšå®¢ç¼–è¾‘ã€‚
    ä½ çš„ä»»åŠ¡æ˜¯ä¸ºæŠ€æœ¯æ–‡ç« é…å›¾ã€‚
    
    æŠ€æœ¯åšå®¢é…å›¾ç‰¹ç‚¹ï¼š
    1. ä¸“ä¸šã€ç®€çº¦
    2. ä»¥å›¾è¡¨ã€ç¤ºæ„å›¾ä¸ºä¸»
    3. é¿å…è¿‡äºèŠ±å“¨
    4. æ ‡å‡†16:9æ¯”ä¾‹
```

---

### 3. åé¦ˆæ”¶é›†å™¨ï¼ˆè½»é‡çº§ï¼‰

**èŒè´£ï¼š**
- æ”¶é›†ç”¨æˆ·åé¦ˆ
- å­˜å‚¨åé¦ˆæ•°æ®
- æä¾›ç®€å•çš„åˆ†æç•Œé¢

**è®¾è®¡ï¼š**

```python
class FeedbackCollector:
    """
    åé¦ˆæ”¶é›†å™¨ï¼ˆç®€åŒ–ç‰ˆï¼‰
    
    åªåšä¸¤ä»¶äº‹ï¼š
    1. è®°å½•åé¦ˆ
    2. æ–¹ä¾¿æŸ¥çœ‹
    
    ä¸åšï¼š
    - è‡ªåŠ¨åˆ†æ
    - è‡ªåŠ¨ä¼˜åŒ–
    - å¤æ‚ç»Ÿè®¡
    """
    
    async def collect_rating(
        self,
        document_id: str,
        rating: int,  # 1-5æ˜Ÿ
        comment: Optional[str] = None,
        user_id: Optional[str] = None
    ):
        """
        æ”¶é›†è¯„åˆ†åé¦ˆ
        """
        feedback = Feedback(
            document_id=document_id,
            rating=rating,
            comment=comment,
            user_id=user_id,
            timestamp=datetime.now()
        )
        
        # ä¿å­˜åˆ°æ•°æ®åº“
        await self.db.save_feedback(feedback)
        
        # å¦‚æœè¯„åˆ†å¾ˆä½ï¼ˆ<=2ï¼‰ï¼Œå‘é€é€šçŸ¥
        if rating <= 2:
            await self.notify_low_rating(feedback)
    
    async def mark_as_good_example(
        self,
        document_id: str,
        user_id: str,
        note: str
    ):
        """
        ç”¨æˆ·æ ‡è®°ä¸º"å¥½æ¡ˆä¾‹"
        """
        await self.db.mark_example(
            document_id=document_id,
            user_id=user_id,
            note=note
        )
    
    def get_feedback_summary(
        self,
        days: int = 7
    ) -> FeedbackSummary:
        """
        è·å–åé¦ˆæ‘˜è¦
        
        ç”¨äºäººå·¥å›é¡¾
        """
        feedbacks = self.db.get_recent_feedbacks(days)
        
        return FeedbackSummary(
            total_count=len(feedbacks),
            avg_rating=sum(f.rating for f in feedbacks) / len(feedbacks),
            low_ratings=[f for f in feedbacks if f.rating <= 2],
            high_ratings=[f for f in feedbacks if f.rating >= 4],
            comments=[f for f in feedbacks if f.comment],
            good_examples=self.db.get_marked_examples(days)
        )
    
    def export_for_review(self) -> str:
        """
        å¯¼å‡ºåé¦ˆæ•°æ®ä¾›äººå·¥review
        
        ç”Ÿæˆmarkdownæ ¼å¼çš„æŠ¥å‘Š
        """
        summary = self.get_feedback_summary(days=7)
        
        report = f"""
# æœ¬å‘¨åé¦ˆæŠ¥å‘Š

## åŸºæœ¬æ•°æ®
- æ€»å¤„ç†æ–‡æ¡£ï¼š{summary.total_count}
- å¹³å‡è¯„åˆ†ï¼š{summary.avg_rating:.2f}/5

## ä½åˆ†æ¡ˆä¾‹ï¼ˆéœ€è¦å…³æ³¨ï¼‰
{self._format_low_ratings(summary.low_ratings)}

## é«˜åˆ†æ¡ˆä¾‹ï¼ˆå€¼å¾—å­¦ä¹ ï¼‰
{self._format_high_ratings(summary.high_ratings)}

## ç”¨æˆ·æ ‡è®°çš„å¥½æ¡ˆä¾‹
{self._format_good_examples(summary.good_examples)}

## å»ºè®®
åŸºäºæœ¬å‘¨åé¦ˆï¼Œè€ƒè™‘ï¼š
1. ...
2. ...
"""
        return report
```

---

### 4. å¹³å°é€‚é…å™¨

**èŒè´£ï¼š**
- æ ¹æ®ä¸åŒå¹³å°è°ƒæ•´è¾“å‡ºæ ¼å¼
- å¤„ç†å¹³å°ç‰¹å®šçš„éœ€æ±‚

**è®¾è®¡ï¼š**

```python
class PlatformAdapter:
    """
    å¹³å°é€‚é…å™¨
    
    ä¸ºä¸åŒå¹³å°åšç‰¹æ®Šå¤„ç†
    """
    
    def adapt_for_xiaohongshu(
        self,
        content: str,
        images: List[GeneratedImage]
    ) -> str:
        """
        é€‚é…å°çº¢ä¹¦
        
        ç‰¹æ®Šå¤„ç†ï¼š
        1. æ·»åŠ emoji
        2. è°ƒæ•´æ®µè½é—´è·
        3. ç”Ÿæˆè¯é¢˜æ ‡ç­¾å»ºè®®
        """
        # 1. æ·»åŠ emojiï¼ˆåœ¨å…³é”®ä½ç½®ï¼‰
        content = self.add_emojis(content)
        
        # 2. ç”Ÿæˆè¯é¢˜æ ‡ç­¾
        tags = self.generate_hashtags(content)
        
        # 3. æ ¼å¼åŒ–
        formatted = f"""
{content}

---

{tags}

ğŸ“¸ å›¾ç‰‡å‡ç”±AIç”Ÿæˆ
"""
        return formatted
    
    def adapt_for_blog(
        self,
        content: str,
        images: List[GeneratedImage]
    ) -> str:
        """
        é€‚é…æŠ€æœ¯åšå®¢
        
        ç‰¹æ®Šå¤„ç†ï¼š
        1. æ·»åŠ ç›®å½•
        2. ä»£ç é«˜äº®æ ‡è®°
        3. SEOä¼˜åŒ–
        """
        # 1. ç”Ÿæˆç›®å½•
        toc = self.generate_toc(content)
        
        # 2. æ·»åŠ å…ƒæ•°æ®
        metadata = f"""
---
title: {self.extract_title(content)}
date: {datetime.now().strftime('%Y-%m-%d')}
tags: {self.extract_tags(content)}
---

{toc}

{content}
"""
        return metadata
    
    def add_emojis(self, content: str) -> str:
        """
        æ™ºèƒ½æ·»åŠ emoji
        
        è§„åˆ™ï¼š
        - æ ‡é¢˜å‰åŠ ç›¸å…³emoji
        - å…³é”®è¯ååŠ å¼ºè°ƒemoji
        """
        # ç®€å•è§„åˆ™åŒ¹é…
        emoji_map = {
            "ä»‹ç»": "ğŸ“",
            "ç‰¹ç‚¹": "âœ¨",
            "ä¼˜åŠ¿": "ğŸ’¡",
            "æ€»ç»“": "ğŸ¯",
            "æ­¥éª¤": "ğŸ“‹"
        }
        
        for keyword, emoji in emoji_map.items():
            if keyword in content:
                content = content.replace(
                    f"## {keyword}",
                    f"{emoji} {keyword}"
                )
        
        return content
    
    def generate_hashtags(self, content: str) -> str:
        """
        ç”Ÿæˆè¯é¢˜æ ‡ç­¾
        
        ç”¨Claudeå¿«é€Ÿç”Ÿæˆ
        """
        # è°ƒç”¨Claudeç”Ÿæˆ3-5ä¸ªç›¸å…³è¯é¢˜æ ‡ç­¾
        pass
```

---

## æ•°æ®æ¨¡å‹ï¼ˆæç®€ï¼‰

### æ•°æ®åº“Schema

```sql
-- æ–‡æ¡£è®°å½•è¡¨
CREATE TABLE documents (
    id VARCHAR(36) PRIMARY KEY,
    user_id VARCHAR(100),  -- emailæˆ–åŒ¿åID
    mode VARCHAR(20),  -- general/xiaohongshu/blog
    original_content TEXT,
    processed_content TEXT,
    image_count INT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- å›¾ç‰‡è®°å½•è¡¨
CREATE TABLE images (
    id VARCHAR(36) PRIMARY KEY,
    document_id VARCHAR(36) REFERENCES documents(id),
    url VARCHAR(500),
    prompt TEXT,
    position INT,  -- åœ¨æ–‡æ¡£ä¸­çš„ä½ç½®
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- åé¦ˆè¡¨
CREATE TABLE feedback (
    id VARCHAR(36) PRIMARY KEY,
    document_id VARCHAR(36) REFERENCES documents(id),
    user_id VARCHAR(100),
    rating INT,  -- 1-5
    comment TEXT,
    is_good_example BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Promptç‰ˆæœ¬å†å²è¡¨
CREATE TABLE prompt_versions (
    id VARCHAR(36) PRIMARY KEY,
    mode VARCHAR(20),
    prompt_type VARCHAR(20),  -- system/analysis
    content TEXT,
    reason TEXT,  -- æ›´æ–°åŸå› 
    created_by VARCHAR(100),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### æ ¸å¿ƒæ•°æ®ç»“æ„

```python
from dataclasses import dataclass
from typing import List, Optional
from datetime import datetime

@dataclass
class ParsedContent:
    """è§£æåçš„å†…å®¹"""
    raw_content: str
    paragraphs: List[str]
    headings: List[str]
    word_count: int
    has_code: bool
    has_lists: bool

@dataclass
class ImageSpec:
    """å›¾ç‰‡è§„æ ¼"""
    position: int  # æ’å…¥ä½ç½®ï¼ˆæ®µè½ç´¢å¼•ï¼‰
    prompt: str  # DALL-E prompt
    caption: str  # å›¾ç‰‡è¯´æ˜
    size: str = "1024x1024"  # å›¾ç‰‡å°ºå¯¸
    style_hint: str = "modern minimalist"  # é£æ ¼æç¤º

@dataclass
class LayoutPlan:
    """å¸ƒå±€è®¡åˆ’"""
    image_specs: List[ImageSpec]
    total_images: int
    strategy: str  # ç­–ç•¥è¯´æ˜

@dataclass
class GeneratedImage:
    """ç”Ÿæˆçš„å›¾ç‰‡"""
    spec: ImageSpec
    url: str  # CDN URL
    original_url: str  # DALL-Eè¿”å›çš„URL
    generated_at: datetime

@dataclass
class ProcessedDocument:
    """å¤„ç†åçš„æ–‡æ¡£"""
    id: str
    original_content: str
    processed_content: str
    images: List[GeneratedImage]
    mode: str
    created_at: datetime

@dataclass
class Feedback:
    """ç”¨æˆ·åé¦ˆ"""
    document_id: str
    user_id: Optional[str]
    rating: int
    comment: Optional[str]
    is_good_example: bool
    timestamp: datetime
```

---

## APIè®¾è®¡ï¼ˆç®€åŒ–ç‰ˆï¼‰

### RESTful Endpoints

```python
from fastapi import FastAPI, UploadFile, File
from pydantic import BaseModel

app = FastAPI()

# ===== æ ¸å¿ƒåŠŸèƒ½ =====

class ProcessRequest(BaseModel):
    content: str
    mode: str = "general"  # general/xiaohongshu/blog

class ProcessResponse(BaseModel):
    document_id: str
    processed_content: str
    images: List[dict]
    preview_url: str  # é¢„è§ˆé¡µé¢URL

@app.post("/api/process")
async def process_document(request: ProcessRequest) -> ProcessResponse:
    """
    å¤„ç†æ–‡æ¡£ - æ ¸å¿ƒAPI
    
    è¾“å…¥ï¼šæ–‡æœ¬å†…å®¹ + æ¨¡å¼
    è¾“å‡ºï¼šå¤„ç†åçš„æ–‡æ¡£
    """
    processor = DocumentProcessor()
    result = await processor.process(
        content=request.content,
        mode=request.mode
    )
    
    return ProcessResponse(
        document_id=result.id,
        processed_content=result.processed_content,
        images=[img.to_dict() for img in result.images],
        preview_url=f"/preview/{result.id}"
    )

# ===== åé¦ˆç›¸å…³ =====

class FeedbackRequest(BaseModel):
    document_id: str
    rating: int  # 1-5
    comment: Optional[str] = None

@app.post("/api/feedback")
async def submit_feedback(request: FeedbackRequest):
    """
    æäº¤åé¦ˆ
    """
    collector = FeedbackCollector()
    await collector.collect_rating(
        document_id=request.document_id,
        rating=request.rating,
        comment=request.comment
    )
    
    return {"status": "ok"}

@app.post("/api/mark-example/{document_id}")
async def mark_as_example(document_id: str, note: str):
    """
    æ ‡è®°ä¸ºå¥½æ¡ˆä¾‹
    """
    collector = FeedbackCollector()
    await collector.mark_as_good_example(
        document_id=document_id,
        note=note
    )
    
    return {"status": "ok"}

# ===== ç®¡ç†åŠŸèƒ½ï¼ˆéœ€è¦è®¤è¯ï¼‰=====

@app.get("/api/admin/feedback-summary")
async def get_feedback_summary(days: int = 7):
    """
    è·å–åé¦ˆæ‘˜è¦ï¼ˆç®¡ç†å‘˜ï¼‰
    """
    collector = FeedbackCollector()
    summary = collector.get_feedback_summary(days)
    
    return summary

@app.get("/api/admin/export-feedback")
async def export_feedback():
    """
    å¯¼å‡ºåé¦ˆæŠ¥å‘Šï¼ˆç®¡ç†å‘˜ï¼‰
    """
    collector = FeedbackCollector()
    report = collector.export_for_review()
    
    return {"report": report}

@app.post("/api/admin/update-prompt")
async def update_prompt(
    mode: str,
    prompt_type: str,
    new_content: str,
    reason: str
):
    """
    æ›´æ–°promptï¼ˆç®¡ç†å‘˜ï¼‰
    """
    manager = PromptManager()
    manager.update_prompt(
        mode=mode,
        prompt_type=prompt_type,
        new_content=new_content,
        reason=reason
    )
    
    return {"status": "ok"}
```

---

## å‰ç«¯è®¾è®¡

### ä¸»ç•Œé¢ï¼ˆå•é¡µé¢ï¼‰

```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ™ºèƒ½é…å›¾å·¥å…·</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50">
    <div class="max-w-4xl mx-auto p-6">
        <!-- å¤´éƒ¨ -->
        <div class="mb-8 text-center">
            <h1 class="text-3xl font-bold mb-2">âœ¨ æ™ºèƒ½é…å›¾å·¥å…·</h1>
            <p class="text-gray-600">ç²˜è´´æ–‡å­—ï¼Œä¸€é”®ç”Ÿæˆå›¾æ–‡å†…å®¹</p>
        </div>

        <!-- æ¨¡å¼é€‰æ‹© -->
        <div class="mb-4 flex gap-4 justify-center">
            <button class="mode-btn active" data-mode="general">
                ğŸ“ é€šç”¨
            </button>
            <button class="mode-btn" data-mode="xiaohongshu">
                ğŸŒŸ å°çº¢ä¹¦
            </button>
            <button class="mode-btn" data-mode="blog">
                ğŸ’» æŠ€æœ¯åšå®¢
            </button>
        </div>

        <!-- è¾“å…¥åŒºåŸŸ -->
        <div class="mb-6">
            <textarea 
                id="content" 
                class="w-full h-64 p-4 border rounded-lg font-mono text-sm"
                placeholder="åœ¨è¿™é‡Œç²˜è´´ä½ çš„å†…å®¹...

æ”¯æŒMarkdownæ ¼å¼ï¼Œä¹Ÿæ”¯æŒçº¯æ–‡æœ¬"
            ></textarea>
        </div>

        <!-- æ“ä½œæŒ‰é’® -->
        <div class="text-center mb-6">
            <button 
                id="process-btn"
                class="bg-blue-600 text-white px-8 py-3 rounded-lg font-medium hover:bg-blue-700 disabled:bg-gray-400"
            >
                ğŸš€ å¼€å§‹å¤„ç†
            </button>
        </div>

        <!-- çŠ¶æ€æ˜¾ç¤º -->
        <div id="status" class="hidden mb-6">
            <!-- çŠ¶æ€å†…å®¹ç”±JSåŠ¨æ€æ›´æ–° -->
        </div>

        <!-- ç»“æœæ˜¾ç¤º -->
        <div id="result" class="hidden">
            <!-- ç»“æœå†…å®¹ç”±JSåŠ¨æ€æ›´æ–° -->
        </div>

        <!-- åé¦ˆåŒºåŸŸ -->
        <div id="feedback" class="hidden mt-6 p-4 bg-white rounded-lg shadow">
            <h3 class="font-medium mb-3">è¿™ä¸ªç»“æœæ€ä¹ˆæ ·ï¼Ÿ</h3>
            <div class="flex gap-2 mb-3">
                <button class="rating-btn" data-rating="5">â­â­â­â­â­</button>
                <button class="rating-btn" data-rating="4">â­â­â­â­</button>
                <button class="rating-btn" data-rating="3">â­â­â­</button>
                <button class="rating-btn" data-rating="2">â­â­</button>
                <button class="rating-btn" data-rating="1">â­</button>
            </div>
            <textarea 
                id="feedback-comment"
                class="w-full p-2 border rounded"
                placeholder="æœ‰ä»€ä¹ˆå»ºè®®å—ï¼Ÿï¼ˆå¯é€‰ï¼‰"
            ></textarea>
            <button id="submit-feedback" class="mt-2 bg-gray-200 px-4 py-2 rounded">
                æäº¤åé¦ˆ
            </button>
        </div>
    </div>

    <script>
        // çŠ¶æ€ç®¡ç†
        let currentMode = 'general';
        let currentDocId = null;

        // æ¨¡å¼åˆ‡æ¢
        document.querySelectorAll('.mode-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.mode-btn').forEach(b => 
                    b.classList.remove('active')
                );
                btn.classList.add('active');
                currentMode = btn.dataset.mode;
            });
        });

        // å¤„ç†æŒ‰é’®
        document.getElementById('process-btn').addEventListener('click', async () => {
            const content = document.getElementById('content').value;
            
            if (!content.trim()) {
                alert('è¯·å…ˆè¾“å…¥å†…å®¹');
                return;
            }

            // æ˜¾ç¤ºè¿›åº¦
            showStatus('processing');

            try {
                const response = await fetch('/api/process', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ content, mode: currentMode })
                });

                const data = await response.json();
                
                // æ˜¾ç¤ºç»“æœ
                showResult(data);
                
                // ä¿å­˜æ–‡æ¡£ID
                currentDocId = data.document_id;
                
                // æ˜¾ç¤ºåé¦ˆè¡¨å•
                document.getElementById('feedback').classList.remove('hidden');

            } catch (error) {
                showStatus('error');
                console.error(error);
            }
        });

        // åé¦ˆæäº¤
        document.getElementById('submit-feedback').addEventListener('click', async () => {
            if (!currentDocId) return;

            const rating = document.querySelector('.rating-btn.selected')?.dataset.rating;
            const comment = document.getElementById('feedback-comment').value;

            if (!rating) {
                alert('è¯·å…ˆæ‰“åˆ†');
                return;
            }

            await fetch('/api/feedback', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    document_id: currentDocId,
                    rating: parseInt(rating),
                    comment: comment || null
                })
            });

            alert('æ„Ÿè°¢åé¦ˆï¼ğŸ™');
            document.getElementById('feedback').classList.add('hidden');
        });

        // è¯„åˆ†æŒ‰é’®
        document.querySelectorAll('.rating-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.rating-btn').forEach(b =>
                    b.classList.remove('selected')
                );
                btn.classList.add('selected');
            });
        });

        function showStatus(type) {
            const status = document.getElementById('status');
            status.classList.remove('hidden');

            if (type === 'processing') {
                status.innerHTML = `
                    <div class="text-center p-6 bg-blue-50 rounded-lg">
                        <div class="animate-spin h-8 w-8 border-4 border-blue-600 border-t-transparent rounded-full mx-auto mb-4"></div>
                        <p class="text-blue-600 font-medium">AIæ­£åœ¨å¤„ç†ä¸­...</p>
                        <p class="text-sm text-gray-600 mt-2">é¢„è®¡éœ€è¦30-60ç§’</p>
                    </div>
                `;
            } else if (type === 'error') {
                status.innerHTML = `
                    <div class="p-6 bg-red-50 rounded-lg text-center">
                        <p class="text-red-600">âŒ å¤„ç†å¤±è´¥ï¼Œè¯·é‡è¯•</p>
                    </div>
                `;
            }
        }

        function showResult(data) {
            document.getElementById('status').classList.add('hidden');
            
            const result = document.getElementById('result');
            result.classList.remove('hidden');
            result.innerHTML = `
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-bold">âœ… å¤„ç†å®Œæˆ</h2>
                        <div class="flex gap-2">
                            <button onclick="downloadMarkdown()" class="px-4 py-2 bg-gray-200 rounded">
                                ğŸ“¥ ä¸‹è½½
                            </button>
                            <button onclick="copyToClipboard()" class="px-4 py-2 bg-blue-600 text-white rounded">
                                ğŸ“‹ å¤åˆ¶
                            </button>
                        </div>
                    </div>
                    
                    <div class="prose max-w-none">
                        <div class="bg-gray-50 p-4 rounded border overflow-auto">
                            <pre class="whitespace-pre-wrap font-mono text-sm">${escapeHtml(data.processed_content)}</pre>
                        </div>
                    </div>

                    <div class="mt-4">
                        <p class="text-sm text-gray-600">
                            ç”Ÿæˆäº† ${data.images.length} å¼ å›¾ç‰‡
                        </p>
                    </div>
                </div>
            `;

            // ä¿å­˜ç»“æœä¾›ä¸‹è½½/å¤åˆ¶
            window.processedContent = data.processed_content;
        }

        function downloadMarkdown() {
            const blob = new Blob([window.processedContent], { type: 'text/markdown' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'processed.md';
            a.click();
        }

        function copyToClipboard() {
            navigator.clipboard.writeText(window.processedContent);
            alert('âœ… å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
        }

        function escapeHtml(text) {
            return text
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;');
        }
    </script>

    <style>
        .mode-btn {
            @apply px-4 py-2 rounded-lg border border-gray-300 hover:border-blue-500 transition;
        }
        .mode-btn.active {
            @apply bg-blue-600 text-white border-blue-600;
        }
        .rating-btn {
            @apply px-3 py-1 border rounded hover:bg-gray-100;
        }
        .rating-btn.selected {
            @apply bg-yellow-100 border-yellow-500;
        }
    </style>
</body>
</html>
```

---

## æ ¸å¿ƒPromptè®¾è®¡

### é€šç”¨æ¨¡å¼Prompt

```yaml
system_prompt: |
  ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„å†…å®¹ç¼–è¾‘å’Œè§†è§‰è®¾è®¡ä¸“å®¶ã€‚
  ä½ çš„ä»»åŠ¡æ˜¯åˆ†ææ–‡æ¡£å†…å®¹ï¼Œå†³å®šåœ¨å“ªé‡Œæ’å…¥æ’å›¾æ¥å¢å¼ºå†…å®¹çš„å¯è¯»æ€§å’Œå¸å¼•åŠ›ã€‚

  æ ¸å¿ƒåŸåˆ™ï¼š
  1. æ’å›¾è¦æœåŠ¡äºå†…å®¹ç†è§£ï¼Œä¸æ˜¯çº¯è£…é¥°
  2. ä½ç½®è¦åˆç†ï¼Œä¸æ‰“æ–­é˜…è¯»æµç•…åº¦
  3. æ•°é‡é€‚ä¸­ï¼š
     - çŸ­æ–‡ï¼ˆ<500å­—ï¼‰ï¼š1-2å¼ 
     - ä¸­ç­‰ï¼ˆ500-1500å­—ï¼‰ï¼š3-4å¼ 
     - é•¿æ–‡ï¼ˆ>1500å­—ï¼‰ï¼š4-5å¼ 
  4. é£æ ¼ç»Ÿä¸€ï¼šç®€çº¦ã€ç°ä»£ã€ä¸“ä¸š

  æ’å›¾ä½ç½®é€‰æ‹©ç­–ç•¥ï¼š
  - åœ¨è§£é‡Šå®Œä¸€ä¸ªé‡è¦æ¦‚å¿µå
  - åœ¨é•¿æ®µè½ä¹‹åï¼ˆ>200å­—ï¼‰
  - åœ¨è¯é¢˜è½¬æ¢çš„åœ°æ–¹
  - åœ¨æ•°æ®æˆ–æ¡ˆä¾‹ä¹‹å

  æ’å›¾å†…å®¹è®¾è®¡ç­–ç•¥ï¼š
  - æŠ½è±¡æ¦‚å¿µ â†’ ç”¨æ¯”å–»/è±¡å¾ç‰©
  - å…·ä½“åœºæ™¯ â†’ ç”¨å†™å®é£æ ¼
  - æŠ€æœ¯å†…å®¹ â†’ ç”¨ç®€å•çš„å›¾è¡¨/ç¤ºæ„å›¾
  - æƒ…æ„Ÿå†…å®¹ â†’ ç”¨æ¸©æš–çš„åœºæ™¯

analysis_template: |
  è¯·åˆ†æä»¥ä¸‹æ–‡æ¡£ï¼Œè®¾è®¡æ’å›¾æ–¹æ¡ˆã€‚

  æ–‡æ¡£ä¿¡æ¯ï¼š
  - æ€»å­—æ•°: {word_count}
  - æ®µè½æ•°: {paragraph_count}
  - æœ‰ä»£ç å—: {has_code}
  - æœ‰åˆ—è¡¨: {has_lists}

  æ–‡æ¡£å†…å®¹ï¼š
  ```
  {content}
  ```

  è¯·è¿”å›JSONæ ¼å¼ï¼ˆåªè¿”å›JSONï¼Œä¸è¦å…¶ä»–å†…å®¹ï¼‰ï¼š
  ```json
  {
    "images": [
      {
        "position": 2,  // åœ¨ç¬¬å‡ æ®µä¹‹åæ’å…¥ï¼ˆä»0å¼€å§‹ï¼‰
        "prompt": "A minimalist illustration of...",  // è¯¦ç»†çš„è‹±æ–‡æè¿°ï¼ŒDALL-E 3ä¼šç”¨
        "caption": "å›¾ç‰‡è¯´æ˜æ–‡å­—",  // ä¸­æ–‡è¯´æ˜
        "reasoning": "ä¸ºä»€ä¹ˆåœ¨è¿™é‡Œæ’å…¥è¿™å¼ å›¾"  // ç®€å•è¯´æ˜ç†ç”±
      }
    ],
    "overall_strategy": "æ•´ä½“ç­–ç•¥è¯´æ˜"
  }
  ```

  æ³¨æ„ï¼š
  - promptå¿…é¡»è¯¦ç»†ï¼ŒåŒ…å«é£æ ¼ã€è‰²å½©ã€æ„å›¾
  - promptå¿…é¡»æ˜¯è‹±æ–‡
  - æ¯ä¸ªå›¾ç‰‡éƒ½è¦æœ‰æ˜ç¡®çš„purpose
```

### å°çº¢ä¹¦æ¨¡å¼Prompt

```yaml
system_prompt: |
  ä½ æ˜¯å°çº¢ä¹¦å†…å®¹è¿è¥ä¸“å®¶ã€‚
  ä½ çš„ä»»åŠ¡æ˜¯ä¸ºå°çº¢ä¹¦ç¬”è®°è®¾è®¡é…å›¾æ–¹æ¡ˆã€‚

  å°çº¢ä¹¦é…å›¾ç‰¹ç‚¹ï¼š
  1. å°é¢å›¾æœ€é‡è¦ - å¿…é¡»å¸å¼•çœ¼çƒï¼Œå†³å®šç‚¹å‡»ç‡
  2. é£æ ¼æ´»æ³¼ã€è‰²å½©é²œè‰³ã€æœ‰ç½‘æ„Ÿ
  3. å¯ä»¥ä½¿ç”¨æµè¡Œå…ƒç´ å’Œemoji
  4. å›¾ç‰‡æ¯”ä¾‹ï¼š1:1ï¼ˆæ–¹å›¾ï¼‰æˆ–3:4ï¼ˆç«–å›¾ï¼‰
  5. é…å›¾æ•°é‡ï¼š3-6å¼ ä¸ºä½³

  å°é¢å›¾è®¾è®¡åŸåˆ™ï¼š
  - è§†è§‰å†²å‡»åŠ›å¼º
  - ä¸»é¢˜æ˜ç¡®
  - è‰²å½©é²œè‰³ä½†ä¸ä¿—æ°”
  - æ–‡å­—å°‘æˆ–æ— æ–‡å­—ï¼ˆå›¾ç‰‡ä¼šè‡ªåŠ¨åŠ æ ‡é¢˜ï¼‰

  å†…å®¹å›¾è®¾è®¡åŸåˆ™ï¼š
  - å‘¼åº”æ–‡å­—å†…å®¹
  - é£æ ¼ç»Ÿä¸€
  - é€‚åˆæ‰‹æœºé˜…è¯»

analysis_template: |
  è¿™æ˜¯ä¸€ç¯‡å‡†å¤‡å‘å°çº¢ä¹¦çš„ç¬”è®°ã€‚

  å†…å®¹ï¼š
  ```
  {content}
  ```

  è¯·è®¾è®¡é…å›¾æ–¹æ¡ˆï¼Œç‰¹åˆ«æ³¨æ„ï¼š
  1. ç¬¬ä¸€å¼ ä¸€å®šæ˜¯å°é¢å›¾ï¼Œå¿…é¡»å¸å¼•äºº
  2. å…¶ä»–å›¾ç‰‡è¦å‘¼åº”å†…å®¹
  3. æ•´ä½“é£æ ¼è¦é€‚åˆå°çº¢ä¹¦æ°›å›´

  è¿”å›JSONï¼š
  ```json
  {
    "cover": {
      "prompt": "Vibrant and eye-catching illustration for social media cover...",
      "caption": "å°é¢å›¾è¯´æ˜",
      "style_keywords": ["colorful", "modern", "social media style"]
    },
    "images": [
      {
        "position": 1,
        "prompt": "...",
        "caption": "...",
        "purpose": "é…åˆç¬¬ä¸€ä¸ªé‡ç‚¹"
      }
    ],
    "hashtag_suggestions": ["#æŠ€æœ¯åˆ†äº«", "#å¹²è´§"],
    "overall_strategy": "ç­–ç•¥è¯´æ˜"
  }
  ```
```

### æŠ€æœ¯åšå®¢æ¨¡å¼Prompt

```yaml
system_prompt: |
  ä½ æ˜¯æŠ€æœ¯åšå®¢ç¼–è¾‘ã€‚
  ä½ çš„ä»»åŠ¡æ˜¯ä¸ºæŠ€æœ¯æ–‡ç« è®¾è®¡é…å›¾ã€‚

  æŠ€æœ¯åšå®¢é…å›¾ç‰¹ç‚¹ï¼š
  1. ä¸“ä¸šã€ç®€çº¦ã€æ¸…æ™°
  2. ä»¥ç¤ºæ„å›¾ã€æµç¨‹å›¾ã€æ¶æ„å›¾ä¸ºä¸»
  3. é¿å…è¿‡äºèŠ±å“¨
  4. æ ‡å‡†16:9æ¯”ä¾‹ï¼Œé€‚åˆåšå®¢å¹³å°
  5. é¢œè‰²ï¼šä¸­æ€§è‰²è°ƒï¼Œçªå‡ºé‡ç‚¹

  æ’å›¾ç±»å‹ï¼š
  - æ¦‚å¿µè§£é‡Š â†’ ç®€å•çš„å›¾æ ‡æˆ–ç¤ºæ„å›¾
  - æ¶æ„è¯´æ˜ â†’ æ–¹æ¡†å›¾ã€æµç¨‹å›¾é£æ ¼
  - å¯¹æ¯”è¯´æ˜ â†’ å·¦å³å¯¹æ¯”å›¾
  - æ­¥éª¤è¯´æ˜ â†’ å¸¦æ•°å­—çš„æ­¥éª¤å›¾

analysis_template: |
  è¿™æ˜¯ä¸€ç¯‡æŠ€æœ¯åšå®¢æ–‡ç« ã€‚

  å†…å®¹ï¼š
  ```
  {content}
  ```

  è¯·è®¾è®¡é…å›¾æ–¹æ¡ˆï¼Œè¦æ±‚ï¼š
  1. ä¸“ä¸šã€ç®€çº¦
  2. æœ‰åŠ©äºæŠ€æœ¯ç†è§£
  3. é€‚åˆåšå®¢å¹³å°å±•ç¤º

  è¿”å›JSONï¼š
  ```json
  {
    "images": [
      {
        "position": 1,
        "prompt": "Clean and professional technical diagram showing...",
        "caption": "å›¾1: æ¶æ„ç¤ºæ„å›¾",
        "type": "diagram",  // diagram/flowchart/comparison/icon
        "style_keywords": ["minimalist", "technical", "professional"]
      }
    ],
    "overall_strategy": "ä¸ºè¿™ç¯‡æŠ€æœ¯æ–‡ç« è®¾è®¡äº†Xå¼ ç¤ºæ„å›¾ï¼Œå¸®åŠ©è¯»è€…ç†è§£..."
  }
  ```
```

---

## éƒ¨ç½²æ–¹æ¡ˆ

### æ¨èæ–¹æ¡ˆï¼šVercel + Cloudflare

**ä¸ºä»€ä¹ˆé€‰è¿™ä¸ªç»„åˆï¼š**
- âœ… éƒ¨ç½²ç®€å•ï¼ˆå‡ åˆ†é’Ÿæå®šï¼‰
- âœ… å…è´¹é¢åº¦å¤Ÿç”¨ï¼ˆæ—©æœŸï¼‰
- âœ… è‡ªåŠ¨HTTPS
- âœ… å…¨çƒCDN
- âœ… é›¶è¿ç»´

### éƒ¨ç½²æ­¥éª¤

```bash
# 1. é¡¹ç›®ç»“æ„
smart-illustration-tool/
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py          # FastAPIå…¥å£
â”‚   â”œâ”€â”€ processor.py     # æ–‡æ¡£å¤„ç†å™¨
â”‚   â”œâ”€â”€ prompts.py       # Promptç®¡ç†
â”‚   â””â”€â”€ feedback.py      # åé¦ˆæ”¶é›†
â”œâ”€â”€ static/
â”‚   â””â”€â”€ index.html       # å‰ç«¯é¡µé¢
â”œâ”€â”€ prompts.yaml         # Prompté…ç½®
â”œâ”€â”€ requirements.txt     # Pythonä¾èµ–
â”œâ”€â”€ vercel.json         # Vercelé…ç½®
â””â”€â”€ README.md

# 2. vercel.jsoné…ç½®
{
  "builds": [
    {
      "src": "api/main.py",
      "use": "@vercel/python"
    },
    {
      "src": "static/**",
      "use": "@vercel/static"
    }
  ],
  "routes": [
    {
      "src": "/api/(.*)",
      "dest": "api/main.py"
    },
    {
      "src": "/(.*)",
      "dest": "static/$1"
    }
  ],
  "env": {
    "ANTHROPIC_API_KEY": "@anthropic_api_key",
    "OPENAI_API_KEY": "@openai_api_key"
  }
}

# 3. ä¸€é”®éƒ¨ç½²
vercel deploy --prod
```

### å›¾ç‰‡CDNï¼šCloudflare R2

```python
# å›¾ç‰‡ä¸Šä¼ åˆ°R2
import boto3

s3 = boto3.client(
    's3',
    endpoint_url='https://YOUR_ACCOUNT_ID.r2.cloudflarestorage.com',
    aws_access_key_id=os.getenv('R2_ACCESS_KEY'),
    aws_secret_access_key=os.getenv('R2_SECRET_KEY')
)

def upload_to_cdn(image_data: bytes, filename: str) -> str:
    """ä¸Šä¼ å›¾ç‰‡åˆ°R2å¹¶è¿”å›CDN URL"""
    s3.put_object(
        Bucket='illustrations',
        Key=filename,
        Body=image_data,
        ContentType='image/png'
    )
    
    # è¿”å›CDN URL
    return f"https://cdn.yourdomain.com/{filename}"
```

---

## æˆæœ¬ä¼°ç®—

### APIæˆæœ¬ï¼ˆå•æ¬¡å¤„ç†ï¼‰

**Claudeåˆ†æï¼š**
- è¾“å…¥ï¼š~1K tokensï¼ˆæ–‡æ¡£å†…å®¹ï¼‰
- è¾“å‡ºï¼š~1K tokensï¼ˆå¸ƒå±€åˆ†æJSONï¼‰
- æˆæœ¬ï¼š$0.003 (input) + $0.015 (output) = **$0.018**

**DALL-E 3ç”Ÿæˆï¼š**
- 3å¼ å›¾ç‰‡ Ã— $0.04 = **$0.12**

**å•æ¬¡æ€»æˆæœ¬ï¼š~$0.14**

### æœˆåº¦æˆæœ¬é¢„ä¼°

**åœºæ™¯1ï¼šè½»åº¦ä½¿ç”¨ï¼ˆ10ä¸ªæœ‹å‹ï¼Œæ¯äººæ¯å‘¨5æ¬¡ï¼‰**
- ä½¿ç”¨æ¬¡æ•°ï¼š10äºº Ã— 5æ¬¡/å‘¨ Ã— 4å‘¨ = 200æ¬¡/æœˆ
- AIæˆæœ¬ï¼š200 Ã— $0.14 = **$28/æœˆ**
- åŸºç¡€è®¾æ–½ï¼š**$0**ï¼ˆVercelå…è´¹ç‰ˆå¤Ÿç”¨ï¼‰
- **æ€»è®¡ï¼š~$30/æœˆ**

**åœºæ™¯2ï¼šä¸­åº¦ä½¿ç”¨ï¼ˆ50ä¸ªç”¨æˆ·ï¼Œæ¯äººæ¯å‘¨3æ¬¡ï¼‰**
- ä½¿ç”¨æ¬¡æ•°ï¼š50äºº Ã— 3æ¬¡/å‘¨ Ã— 4å‘¨ = 600æ¬¡/æœˆ
- AIæˆæœ¬ï¼š600 Ã— $0.14 = **$84/æœˆ**
- åŸºç¡€è®¾æ–½ï¼šVercel Pro **$20/æœˆ**ï¼ˆéœ€è¦æ›´å¤šå¸¦å®½ï¼‰
- **æ€»è®¡ï¼š~$100/æœˆ**

**åœºæ™¯3ï¼šé‡åº¦ä½¿ç”¨ï¼ˆ200ä¸ªç”¨æˆ·ï¼‰**
- ä½¿ç”¨æ¬¡æ•°ï¼š200äºº Ã— 3æ¬¡/å‘¨ Ã— 4å‘¨ = 2400æ¬¡/æœˆ
- AIæˆæœ¬ï¼š2400 Ã— $0.14 = **$336/æœˆ**
- åŸºç¡€è®¾æ–½ï¼š**$50/æœˆ**ï¼ˆéœ€è¦ç‹¬ç«‹æœåŠ¡å™¨ï¼‰
- **æ€»è®¡ï¼š~$400/æœˆ**

### æ”¶è´¹ç­–ç•¥ï¼ˆå¦‚æœéœ€è¦ï¼‰

**å…è´¹ç‰ˆï¼š**
- æ¯æœˆ5æ¬¡å…è´¹
- é€‚åˆå°é²œç”¨æˆ·

**ä»˜è´¹ç‰ˆï¼š**
- $9.9/æœˆï¼š50æ¬¡/æœˆ
- $29/æœˆï¼š200æ¬¡/æœˆ
- $99/æœˆï¼šæ— é™ä½¿ç”¨

**æˆæœ¬å›æ”¶ï¼š**
- 10ä¸ªä»˜è´¹ç”¨æˆ·ï¼ˆ$29ï¼‰ = $290æ”¶å…¥
- è¦†ç›–50äººçš„ä½¿ç”¨æˆæœ¬
- æ—©æœŸä¸æ”¶è´¹ï¼Œç§¯ç´¯ç”¨æˆ·å’Œåé¦ˆ

---

## å¼€å‘è·¯çº¿å›¾

### Phase 1: MVPï¼ˆ1å‘¨ï¼‰

**ç›®æ ‡ï¼š**
æ ¸å¿ƒåŠŸèƒ½å¯ç”¨ï¼Œè‡ªå·±å’Œæœ‹å‹èƒ½ç”¨

**ä»»åŠ¡ï¼š**
- [x] åŸºç¡€æ–‡æ¡£å¤„ç†æµç¨‹
- [x] Claudeå¸ƒå±€åˆ†æ
- [x] DALL-Eå›¾ç‰‡ç”Ÿæˆ
- [x] ç®€å•çš„Webç•Œé¢
- [x] é€šç”¨æ¨¡å¼prompt
- [x] éƒ¨ç½²åˆ°Vercel

**ä¸åŒ…å«ï¼š**
- ç”¨æˆ·ç³»ç»Ÿ
- åé¦ˆæ”¶é›†
- å¹³å°é€‚é…
- æ•°æ®åº“

**äº¤ä»˜æ ‡å‡†ï¼š**
èƒ½æŠŠmarkdownå˜æˆå¸¦å›¾çš„markdown

### Phase 2: åé¦ˆæ”¶é›†ï¼ˆ3å¤©ï¼‰

**ç›®æ ‡ï¼š**
æ”¶é›†ç”¨æˆ·åé¦ˆï¼Œç”¨äºåç»­ä¼˜åŒ–

**ä»»åŠ¡ï¼š**
- [x] æ·»åŠ è¯„åˆ†åŠŸèƒ½ï¼ˆ1-5æ˜Ÿï¼‰
- [x] æ·»åŠ è¯„è®ºåŠŸèƒ½
- [x] ç®€å•çš„åé¦ˆæ•°æ®åº“ï¼ˆSQLiteï¼‰
- [x] ç®¡ç†åå°ï¼ˆæŸ¥çœ‹åé¦ˆï¼‰

**äº¤ä»˜æ ‡å‡†ï¼š**
èƒ½çœ‹åˆ°ç”¨æˆ·è§‰å¾—å¥½ä¸å¥½

### Phase 3: å¹³å°é€‚é…ï¼ˆ3å¤©ï¼‰

**ç›®æ ‡ï¼š**
é’ˆå¯¹å°çº¢ä¹¦å’ŒæŠ€æœ¯åšå®¢ä¼˜åŒ–

**ä»»åŠ¡ï¼š**
- [x] å°çº¢ä¹¦æ¨¡å¼prompt
- [x] æŠ€æœ¯åšå®¢æ¨¡å¼prompt
- [x] å¹³å°é€‚é…å™¨ï¼ˆemojiã€æ ‡ç­¾ç­‰ï¼‰
- [x] æ¨¡å¼åˆ‡æ¢UI

**äº¤ä»˜æ ‡å‡†ï¼š**
ä¸åŒå¹³å°ç”Ÿæˆç»“æœæœ‰æ˜æ˜¾å·®å¼‚

### Phase 4: ä½“éªŒä¼˜åŒ–ï¼ˆ1å‘¨ï¼‰

**ä»»åŠ¡ï¼š**
- [x] å¤„ç†é€Ÿåº¦ä¼˜åŒ–ï¼ˆå¹¶å‘ç”Ÿæˆï¼‰
- [x] é”™è¯¯å¤„ç†ä¼˜åŒ–
- [x] UIç¾åŒ–
- [x] æ·»åŠ ç¤ºä¾‹/æ•™ç¨‹
- [x] å›¾ç‰‡é¢„è§ˆåŠŸèƒ½

**äº¤ä»˜æ ‡å‡†ï¼š**
ç”¨æˆ·ä½“éªŒsmoothï¼Œæ²¡æœ‰æ˜æ˜¾bug

### Phase 5: åŸºç¡€è°ƒæ•™ï¼ˆæŒç»­ï¼‰

**ç›®æ ‡ï¼š**
æ ¹æ®åé¦ˆé€æ­¥ä¼˜åŒ–prompt

**ä»»åŠ¡ï¼š**
- æ¯å‘¨reviewåé¦ˆæ•°æ®
- æ‰¾å‡ºä½åˆ†æ¡ˆä¾‹çš„å…±åŒé—®é¢˜
- æ‰‹åŠ¨è°ƒæ•´prompt
- è®°å½•ä¼˜åŒ–å†å²

**èŠ‚å¥ï¼š**
- æ¯å‘¨äº”review
- æ¯ä¸¤å‘¨æ›´æ–°ä¸€æ¬¡prompt
- æŒç»­3ä¸ªæœˆ

### Phase 6: æ‰©å±•åŠŸèƒ½ï¼ˆå¦‚æœéœ€è¦ï¼‰

**å¯èƒ½çš„æ–¹å‘ï¼š**
- ç”¨æˆ·ç³»ç»Ÿï¼ˆé‚®ç®±ç™»å½•ï¼‰
- å†å²è®°å½•
- æ‰¹é‡å¤„ç†
- APIæ¥å£
- WordPressæ’ä»¶
- æ”¶è´¹åŠŸèƒ½

**åŸåˆ™ï¼š**
åªæœ‰åœ¨ç”¨æˆ·æ˜ç¡®éœ€è¦æ—¶æ‰åš

---

## é£é™©ä¸åº”å¯¹

### æŠ€æœ¯é£é™©

**1. AIæœåŠ¡ä¸ç¨³å®š**
- **é£é™©**ï¼šClaudeæˆ–DALL-Eå¯èƒ½downtime
- **åº”å¯¹**ï¼š
  - æ·»åŠ é‡è¯•æœºåˆ¶
  - ç¼“å­˜æˆåŠŸçš„ç”Ÿæˆç»“æœ
  - å‡†å¤‡é™çº§æ–¹æ¡ˆï¼ˆæ‰‹åŠ¨å¤„ç†ï¼‰

**2. æˆæœ¬å¤±æ§**
- **é£é™©**ï¼šç”¨æˆ·å¾ˆå¤šæ—¶ï¼ŒAPIæˆæœ¬å¯èƒ½å¾ˆé«˜
- **åº”å¯¹**ï¼š
  - è®¾ç½®æ¯ç”¨æˆ·ä½¿ç”¨ä¸Šé™
  - æ—©æœŸè‡ªå·±coverï¼Œå¤Ÿç”¨å‰ä¸æ”¶è´¹
  - è€ƒè™‘ç¼“å­˜ç›¸ä¼¼promptçš„ç»“æœ

**3. ç”Ÿæˆè´¨é‡ä¸ç¨³å®š**
- **é£é™©**ï¼šAIç”Ÿæˆçš„å›¾ç‰‡æœ‰æ—¶å€™å¾ˆç³Ÿç³•
- **åº”å¯¹**ï¼š
  - å…è®¸ç”¨æˆ·regenerateå•å¼ å›¾
  - æ”¶é›†bad casesï¼Œä¼˜åŒ–prompt
  - å®åœ¨ä¸è¡Œå°±äººå·¥ä»‹å…¥

### äº§å“é£é™©

**1. ç”¨æˆ·ä¸æ„¿æ„ç”¨**
- **é£é™©**ï¼šæœ‹å‹è¯•äº†è§‰å¾—ä¸å¥½ç”¨
- **åº”å¯¹**ï¼š
  - æ—©æœŸå¯†é›†æ”¶é›†åé¦ˆ
  - å¿«é€Ÿè¿­ä»£
  - å¦‚æœç¡®å®éœ€æ±‚ä¸å­˜åœ¨ï¼ŒåŠæ—¶stop

**2. ç»“æœä¸å¦‚äººæ„**
- **é£é™©**ï¼šAIé…å›¾æ•ˆæœä¸å¦‚äººå·¥
- **åº”å¯¹**ï¼š
  - å®šä½ä¸º"è¾…åŠ©å·¥å…·"ï¼Œä¸æ˜¯å®Œå…¨æ›¿ä»£
  - å¼ºè°ƒ"çœæ—¶é—´"è€Œä¸æ˜¯"å®Œç¾"
  - å…è®¸ç”¨æˆ·æ‰‹åŠ¨è°ƒæ•´

**3. ç«å“å‡ºç°**
- **é£é™©**ï¼šå¤§å…¬å¸å¯èƒ½æ¨å‡ºç±»ä¼¼åŠŸèƒ½
- **åº”å¯¹**ï¼š
  - å¿«é€Ÿç§¯ç´¯ç”¨æˆ·
  - å»ºç«‹å£ç¢‘
  - å‚ç›´åœºæ™¯ï¼ˆåšä¸»ï¼‰æ·±è€•

### è¿è¥é£é™©

**1. ç»´æŠ¤è´Ÿæ‹…**
- **é£é™©**ï¼šå‡ºbugæ—¶æ²¡æ—¶é—´ä¿®
- **åº”å¯¹**ï¼š
  - ä»£ç ç®€å•æ˜“ç»´æŠ¤
  - æ·»åŠ å®Œå–„çš„é”™è¯¯ç›‘æ§
  - æ—©æœŸç”¨æˆ·å°‘ï¼Œé—®é¢˜å°‘

**2. ç”¨æˆ·æœŸæœ›è¿‡é«˜**
- **é£é™©**ï¼šæœ‹å‹æœŸæœ›å¤ªé«˜ï¼Œå¤±æœ›
- **åº”å¯¹**ï¼š
  - æ˜ç¡®å®šä½ï¼šå°å·¥å…·ï¼Œä¸æ˜¯å®Œæ•´äº§å“
  - ç®¡ç†é¢„æœŸï¼šçœæ—¶é—´ï¼Œä¸æ˜¯å®Œç¾
  - å¿«é€Ÿå“åº”åé¦ˆ

---

## æˆåŠŸæŒ‡æ ‡

### äº§å“æŒ‡æ ‡

**æ ¸å¿ƒæŒ‡æ ‡ï¼š**
- **ç”¨æˆ·æ»¡æ„åº¦**ï¼šå¹³å‡è¯„åˆ† >4.0/5
  - è¡¡é‡ï¼šå¥½ä¸å¥½ç”¨
- **ä½¿ç”¨é¢‘ç‡**ï¼šå‘¨æ´»è·ƒç”¨æˆ· / æ€»ç”¨æˆ· >30%
  - è¡¡é‡ï¼šæœ‰æ²¡æœ‰ç”¨
- **å®Œæˆç‡**ï¼šå¤„ç†æˆåŠŸ / å°è¯•å¤„ç† >90%
  - è¡¡é‡ï¼šç¨³ä¸ç¨³å®š

**æ¬¡è¦æŒ‡æ ‡ï¼š**
- å¹³å‡å¤„ç†æ—¶é—´ <60ç§’
- ç”¨æˆ·ç•™å­˜ç‡ï¼ˆ1å‘¨åè¿˜ç”¨ï¼‰ >50%
- æ¨èç‡ï¼ˆç”¨æˆ·æ¨èç»™æœ‹å‹ï¼‰ >20%

### å­¦ä¹ ç³»ç»ŸæŒ‡æ ‡

**ä¼˜åŒ–æ•ˆæœï¼š**
- Promptç‰ˆæœ¬è¿­ä»£é¢‘ç‡ï¼šæ¯2å‘¨1æ¬¡
- æ¯æ¬¡è¿­ä»£è¯„åˆ†æå‡ >0.1åˆ†
- ä½åˆ†æ¡ˆä¾‹å æ¯” <20%

### å¢é•¿æŒ‡æ ‡ï¼ˆå¦‚æœåšå¤§ï¼‰

**ç”¨æˆ·å¢é•¿ï¼š**
- æœˆæ–°å¢ç”¨æˆ· >20%
- è‡ªç„¶å¢é•¿ï¼ˆæœ‹å‹æ¨èï¼‰ >50%
- ç•™å­˜ç‡ï¼ˆ3ä¸ªæœˆï¼‰ >30%

**å•†ä¸šæŒ‡æ ‡ï¼ˆå¦‚æœæ”¶è´¹ï¼‰ï¼š**
- ä»˜è´¹è½¬åŒ–ç‡ >5%
- å®¢å•ä»· >$20
- CAC < $10ï¼ˆé€šè¿‡å£ç¢‘ï¼Œè·å®¢æˆæœ¬ä½ï¼‰

---

## åç»­è¿­ä»£æ–¹å‘

### çŸ­æœŸï¼ˆ1-3ä¸ªæœˆï¼‰

**åŸºäºåé¦ˆä¼˜åŒ–ï¼š**
1. PromptæŒç»­ä¼˜åŒ–ï¼ˆæœ€é‡è¦ï¼‰
2. å¢åŠ å›¾ç‰‡é£æ ¼é€‰é¡¹
3. æ”¯æŒç”¨æˆ·è‡ªå®šä¹‰è§„åˆ™
4. æ·»åŠ æ›´å¤šå¹³å°æ¨¡å¼

### ä¸­æœŸï¼ˆ3-6ä¸ªæœˆï¼‰

**æ‰©å±•åŠŸèƒ½ï¼š**
1. ç”¨æˆ·ç³»ç»Ÿï¼ˆä¿å­˜å†å²ï¼‰
2. æ‰¹é‡å¤„ç†
3. å›¢é˜Ÿåä½œåŠŸèƒ½
4. WordPress/Notionæ’ä»¶

### é•¿æœŸï¼ˆ6-12ä¸ªæœˆï¼‰

**å¦‚æœçœŸçš„åšå¤§ï¼š**
1. è‡ªåŠ¨å­¦ä¹ ç³»ç»Ÿï¼ˆè€Œä¸æ˜¯æ‰‹åŠ¨ï¼‰
2. ä¸ªæ€§åŒ–é£æ ¼è®°å¿†
3. APIå¼€æ”¾
4. ä¼ä¸šç‰ˆåŠŸèƒ½

### ä½†æ˜¯...

**ç°åœ¨ä¸æƒ³è¿™ä¹ˆå¤šã€‚**

**å…ˆåšMVPï¼Œç»™æœ‹å‹ç”¨ï¼Œçœ‹åé¦ˆã€‚**

å¥½ç”¨å°±ç»§ç»­ï¼Œä¸å¥½ç”¨å°±ç®—äº†ã€‚

åæ­£å°±å†™ç€ç©ã€‚

---

## é™„å½•ï¼šå¿«é€Ÿå¯åŠ¨æŒ‡å—

### æœ€å°å¯è¡Œç‰ˆæœ¬ï¼ˆ200è¡Œä»£ç ï¼‰

**æ–‡ä»¶1ï¼šapi/main.py**

```python
from fastapi import FastAPI, Request
from fastapi.staticfiles import StaticFiles
from anthropic import Anthropic
from openai import OpenAI
import json
import os
import asyncio

app = FastAPI()
app.mount("/static", StaticFiles(directory="static"), name="static")

claude = Anthropic(api_key=os.getenv("ANTHROPIC_API_KEY"))
openai_client = OpenAI(api_key=os.getenv("OPENAI_API_KEY"))

PROMPT = """
åˆ†æè¿™ä¸ªæ–‡æ¡£ï¼Œå†³å®šåœ¨å“ªé‡Œæ’å›¾ï¼ˆ3-5å¼ ï¼‰ã€‚

æ–‡æ¡£ï¼š
{content}

è¿”å›JSONï¼š
{{
  "images": [
    {{
      "position": æ®µè½ç´¢å¼•,
      "prompt": "è‹±æ–‡æè¿°",
      "caption": "ä¸­æ–‡è¯´æ˜"
    }}
  ]
}}
"""

@app.post("/api/process")
async def process(request: Request):
    data = await request.json()
    content = data['content']
    
    # 1. Claudeåˆ†æ
    response = claude.messages.create(
        model="claude-sonnet-4-20250514",
        max_tokens=2000,
        messages=[{
            "role": "user",
            "content": PROMPT.format(content=content)
        }]
    )
    
    layout = json.loads(response.content[0].text)
    
    # 2. ç”Ÿæˆå›¾ç‰‡ï¼ˆå¹¶å‘ï¼‰
    async def gen(spec):
        r = await openai_client.images.generate(
            model="dall-e-3",
            prompt=spec['prompt'],
            size="1024x1024"
        )
        return r.data[0].url
    
    tasks = [gen(spec) for spec in layout['images']]
    images = await asyncio.gather(*tasks)
    
    # 3. æ’å…¥markdown
    paras = content.split('\n\n')
    for i, spec in enumerate(layout['images']):
        img_md = f"\n\n![{spec['caption']}]({images[i]})\n*{spec['caption']}*\n\n"
        paras.insert(spec['position'], img_md)
    
    result = '\n\n'.join(paras)
    
    return {"processed_content": result, "images": images}

if __name__ == "__main__":
    import uvicorn
    uvicorn.run(app, host="0.0.0.0", port=8000)
```

**æ–‡ä»¶2ï¼šstatic/index.html**

ï¼ˆå‰é¢å·²ç»æä¾›ï¼Œè¿™é‡Œçœç•¥ï¼‰

**éƒ¨ç½²ï¼š**

```bash
# 1. å®‰è£…ä¾èµ–
pip install fastapi anthropic openai uvicorn

# 2. æœ¬åœ°è¿è¡Œ
python api/main.py

# 3. è®¿é—®
http://localhost:8000
```

**å®Œæˆï¼**

---

## æ€»ç»“

è¿™æ˜¯ä¸€ä¸ª**è½»é‡çº§**çš„æ™ºèƒ½é…å›¾å·¥å…·è®¾è®¡ã€‚

**æ ¸å¿ƒç‰¹ç‚¹ï¼š**
- âœ… ç®€å•æ˜“ç”¨ï¼ˆä¸€é”®å¤„ç†ï¼‰
- âœ… å¿«é€Ÿå¼€å‘ï¼ˆ1å‘¨MVPï¼‰
- âœ… ä½æˆæœ¬è¿è¡Œï¼ˆæ—©æœŸ<$50/æœˆï¼‰
- âœ… æ¸è¿›ä¼˜åŒ–ï¼ˆåŸºäºåé¦ˆæ‰‹åŠ¨è°ƒæ•™ï¼‰
- âœ… é€‚åˆå°è§„æ¨¡ï¼ˆ10-100ä¸ªæœ‹å‹ï¼‰

**ä¸æ˜¯ï¼š**
- âŒ å¤æ‚çš„ä¼ä¸šç³»ç»Ÿ
- âŒ è‡ªåŠ¨å­¦ä¹ çš„AIç³»ç»Ÿ
- âŒ éœ€è¦èèµ„çš„startup

**å°±æ˜¯ï¼š**
- âœ… ä¸€ä¸ªå¥½ç”¨çš„å°å·¥å…·
- âœ… ç»™æœ‹å‹çœæ—¶é—´
- âœ… å†™ç€ç©ï¼Œé¡ºä¾¿å¯èƒ½æœ‰ç”¨

**ä¸‹ä¸€æ­¥ï¼š**
1. èŠ±1å‘¨æ—¶é—´å®ç°MVP
2. ç»™CEOæœ‹å‹è¯•ç”¨
3. ç»™å‡ ä¸ªåšä¸»æœ‹å‹è¯•ç”¨
4. æ”¶é›†åé¦ˆ
5. å†³å®šè¦ä¸è¦ç»§ç»­

**å¦‚æœå¥½ç”¨ï¼š**
è‡ªç„¶ä¼šæœ‰æ›´å¤šäººè¦ç”¨ï¼Œåˆ°æ—¶å€™å†è¿­ä»£ã€‚

**å¦‚æœä¸å¥½ç”¨ï¼š**
ä¹Ÿå°±å‡ å¤©æ—¶é—´ï¼Œå­¦åˆ°äº†ä»€ä¹ˆæ˜¯çœŸå®éœ€æ±‚ã€‚

---

*è®¾è®¡æ–‡æ¡£ v1.0*
*åˆ›å»ºæ—¥æœŸ: 2026-01-15*
*ä½œè€…: Zhilin*
*å®šä½: å†™ç€ç©çš„å°å·¥å…·*
